<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ML Prediction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-5">
  <h1 class="mb-4">Predict with Best Model</h1>

  <!-- Input cho số lượng mảng -->
  <div class="mb-3">
    <label for="numSamples" class="form-label">Số lượng mảng random:</label>
    <input type="number" id="numSamples" class="form-control" placeholder="Nhập số mảng (mặc định = 1)">
  </div>

  <button id="predictBtn" class="btn btn-primary">Submit</button>

  <div id="result" class="mt-4"></div>

  <script>
    document.getElementById("predictBtn").addEventListener("click", async () => {
      let numSamples = parseInt(document.getElementById("numSamples").value);
      if (isNaN(numSamples) || numSamples <= 0) {
        numSamples = 1; // mặc định = 1
      }

      // Random mỗi sample có 20 features
      const features = [];
      for (let i = 0; i < numSamples; i++) {
        let arr = Array.from({ length: 20 }, () => +(Math.random() * 10).toFixed(1));
        features.push(arr);
      }

      const response = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ features: features }),
      });

      const data = await response.json();
      if (response.ok) {
        document.getElementById("result").innerHTML = `
          <p class="text-success">Prediction: ${JSON.stringify(data.predictions)}</p>
          <p><b>Input features:</b><br>${features.map(f => `[${f.join(", ")}]`).join("<br>")}</p>
        `;
      } else {
        document.getElementById("result").innerHTML = `
          <p class="text-danger">Error: ${data.error}</p>
        `;
      }
    });
  </script>
</body>
</html>
